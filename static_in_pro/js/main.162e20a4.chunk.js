(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{58:function(e,t,n){e.exports=n(95)},63:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(17),s=n.n(i),o=(n(63),n(9)),c=n(10),d=n(13),l=n(11),u=n(12),h=n(6),p=n(15),m=(n(68),n(30)),_=n.n(m),b=function(e,t,n){fetch(t,{method:"GET",headers:{"Content-Type":"application/json",mode:"no-cors"}}).then(function(e){return e.json()}).then(function(t){e({type:n,data:t})}).catch(function(e){console.log("error",e)})},g=function(e,t,n,a){var r=_.a.load("csrftoken");if(void 0!==r){var i={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":r},body:JSON.stringify(a),credentials:"include"};fetch(t,i).then(function(e){return e.json()}).then(function(t){e({type:n,data:t})}).catch(function(e){console.log("error qwer",e)})}},f=function(e,t,n,a){var r=_.a.load("csrftoken");if(void 0!==r){var i={method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":r},body:JSON.stringify(a),credentials:"include"};fetch(t,i).then(function(e){return e.json()}).then(function(t){e({type:n,data:t})}).catch(function(e){console.log("error qwer",e)})}},E=function(e,t){var n="/api/orders/ingredient_destroy/".concat(t,"/");return function(e){!function(e,t,n,a){var r=_.a.load("csrftoken");void 0!==r&&fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRFToken":r}}).then(function(t){e({type:n,data:a})}).catch(function(e){console.log("error qwer",e)})}(e,n,"DELETE_INGREDIENT_IN_BASKET",t)}},O=function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(l.a)(t).call(this,e,n))).handleDoughInputChange=a.handleDoughInputChange.bind(Object(h.a)(Object(h.a)(a))),a.state={dough_id_in_basket:!1},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleDoughInputChange",value:function(e){var t=this,n=this.props.ingredients_in_basket,a=!1;n.forEach(function(n,r){n.is_dough&&(t.props.updateDoughInBasket(e,n.id),a=!0)}),a||this.props.addDoughToBasket(e)}},{key:"findDoughIdInBasket",value:function(){var e=this.props.ingredients_in_basket,t=!1;e.forEach(function(e,n){e.is_dough&&(t=e.ingredient)}),this.setState({dough_id_in_basket:t})}},{key:"componentDidUpdate",value:function(e){this.props.ingredients_in_basket!==e.ingredients_in_basket&&this.findDoughIdInBasket()}},{key:"render",value:function(){var e=this,t=this.props,n=t.category,a=t.ingredients,i=this.state.dough_id_in_basket;return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("p",null,r.a.createElement("b",null,n.name,":")),a.map(function(t,a){return t.category===n.id?r.a.createElement("label",{key:a,style:{margin:"0 10px 0 0"}},r.a.createElement("input",{onChange:e.handleDoughInputChange,type:"radio",checked:i===t.id,name:"dough",value:t.id})," ",t.name," (",t.price," UAH)"):""})),r.a.createElement("hr",null))}}]),t}(a.Component),v=Object(p.b)(function(e){return{ingredients_in_basket:e.order.ingredients_in_basket}},function(e){return{addDoughToBasket:function(t){return e(function(e){var t={ingredient:parseInt(e.target.value),nmb:1};return function(e){g(e,"/api/orders/add_ingredient/","ADD_INGREDIENT_TO_BASKET",t)}}(t))},updateDoughInBasket:function(t,n){return e(function(e,t){var n="/api/orders/basket_update/".concat(t,"/"),a={ingredient:parseInt(e.target.value),nmb:1};return function(e){f(e,n,"UPDATE_INGREDIENT_IN_BASKET",a)}}(t,n))}}})(O),k=function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(l.a)(t).call(this,e,n))).handleIngredientInputChange=a.handleIngredientInputChange.bind(Object(h.a)(Object(h.a)(a))),a.state={nmb:!1,ingredient_id_in_basket:!1},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"defineIngredientQuantity",value:function(e,t){var n=!1,a=!1;t.forEach(function(t,r){parseInt(t.ingredient)===e.id&&(n=t.nmb,a=t.id)}),this.setState({nmb:n,ingredient_id_in_basket:a})}},{key:"handleIngredientInputChange",value:function(e){e.preventDefault(),this.state.nmb&&this.state.ingredient_id_in_basket?e.target.value&&0!==parseInt(e.target.value)?this.props.updateIngredientInBasket(e,this.state.ingredient_id_in_basket):this.props.destroyIngredientInBasket(e,this.state.ingredient_id_in_basket):parseInt(e.target.value)&&this.props.addIngredientToBasket(e)}},{key:"componentDidUpdate",value:function(e){this.props.ingredients_in_basket!==e.ingredients_in_basket&&this.defineIngredientQuantity(this.props.ingredient,this.props.ingredients_in_basket)}},{key:"render",value:function(){var e=this.props.ingredient;return this.state.nmb?r.a.createElement("input",{type:"number",min:"0",onBlur:this.handleIngredientInputChange,name:e.id,defaultValue:this.state.nmb}):r.a.createElement("div",null,r.a.createElement("input",{type:"number",min:"0",onBlur:this.handleIngredientInputChange,name:e.id,placeholder:"Enter quantity"}))}}]),t}(a.Component),I=Object(p.b)(function(e){return{ingredients_in_basket:e.order.ingredients_in_basket}},function(e){return{addIngredientToBasket:function(t){return e(function(e){var t={ingredient:parseInt(e.target.name),nmb:e.target.value};return function(e){g(e,"/api/orders/add_ingredient/","ADD_INGREDIENT_TO_BASKET",t)}}(t))},updateIngredientInBasket:function(t,n){return e(function(e,t){var n="/api/orders/basket_update/".concat(t,"/"),a={ingredient:parseInt(e.target.name),nmb:e.target.value};return function(e){f(e,n,"UPDATE_INGREDIENT_IN_BASKET",a)}}(t,n))},destroyIngredientInBasket:function(t,n){return e(E(0,n))}}})(k),j=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.category_id,n=e.category_name,a=e.ingredients;return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("p",null,r.a.createElement("b",null,n,":")),r.a.createElement("div",{style:{display:"flex"}},a.map(function(e,n){return e.category===t?r.a.createElement("div",{key:n,style:{margin:"0 10px 0 0"}},r.a.createElement("label",null,e.name," (",e.price," UAH) ",r.a.createElement("br",null),r.a.createElement(I,{ingredient:e}))):""}))),r.a.createElement("hr",null))}}]),t}(a.Component),S=function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(l.a)(t).call(this,e,n))).state={total_price:0},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"totalPrice",value:function(){var e=0;this.props.ingredients_in_basket.forEach(function(t,n){e+=parseInt(t.total_price)}),this.setState({total_price:e})}},{key:"componentDidMount",value:function(){this.props.loadCategories(),this.props.loadIngredients(),this.props.loadIngredientsInBasket()}},{key:"componentDidUpdate",value:function(e){this.props.ingredients_in_basket!==e.ingredients_in_basket&&this.totalPrice()}},{key:"render",value:function(){var e=this.props,t=e.categories,n=e.ingredients,a=this.state.total_price;return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-center"},"Pizza Chef"),r.a.createElement("h3",null,"Choose ingredients and create your Pizza!"),t.map(function(e,t){return r.a.createElement("div",{key:t},e.is_dough?r.a.createElement(v,{category:e,ingredients:n}):r.a.createElement(j,{category_id:e.id,category_name:e.name,ingredients:n}))}),a?r.a.createElement("p",null,"Total price: ",a," UAH"):"")}}]),t}(a.Component),y=Object(p.b)(function(e){return{categories:e.menu.categories,ingredients:e.menu.ingredients,ingredients_in_basket:e.order.ingredients_in_basket}},function(e){return{loadCategories:function(){return e(function(e){b(e,"/api/menu/categories/","LOAD_CATEGORIES")})},loadIngredients:function(){return e(function(e){b(e,"/api/menu/ingredients/","LOAD_INGREDIENTS")})},loadIngredientsInBasket:function(){return e(function(e){b(e,"/api/orders/add_ingredient/","LOAD_INGREDIENTS_IN_BASKET")})}}})(S),T=n(7),C=n(99),D=n(97),w=n(98),N=n(96),A=n(51),R=function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(l.a)(t).call(this,e,n))).handleSubmit=a.handleSubmit.bind(Object(h.a)(Object(h.a)(a))),a.state={phone_invalid:!1,email_invalid:!1},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.props,n=t.showSpiner,a=t.form,r=t.submitOrderForm;n(),r(a)}},{key:"showInvalidFields",value:function(e){this.props.setFalseToValidationError(),e.phone&&e.email&&this.setState(Object(T.a)({},this.state,{phone_invalid:!0,email_invalid:!0})),!e.phone&&e.email&&this.setState(Object(T.a)({},this.state,{phone_invalid:!1,email_invalid:!0})),e.phone&&!e.email&&this.setState(Object(T.a)({},this.state,{phone_invalid:!0,email_invalid:!1}))}},{key:"hideInvalidFields",value:function(){this.setState(Object(T.a)({},this.state,{phone_invalid:!1,email_invalid:!1}))}},{key:"componentDidUpdate",value:function(e){this.props.order_id&&(this.props.showSpiner(),this.props.moveIngredientsFromBasketToOrder(this.props.order_id)),this.props.validation_error&&(this.props.closeSpiner(),this.showInvalidFields(this.props.validation_error)),this.props.success_message&&(this.hideInvalidFields(),this.props.showSuccessMessage(),this.props.setFalseToSuccessMessage())}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.email,a=e.phone,i=e.comments;return r.a.createElement(w.a,{onSubmit:this.handleSubmit},r.a.createElement(w.a.Group,{controlId:"formClientName"},r.a.createElement(w.a.Label,null,"Name"),r.a.createElement(w.a.Control,{type:"text",name:"name",required:!0,placeholder:"Enter your name",defaultValue:t||"",onChange:this.props.handleOrderFormInputChange})),r.a.createElement(w.a.Group,{controlId:"formClientPhoneNumber"},r.a.createElement(w.a.Label,null,"Phone number"),r.a.createElement(w.a.Control,{type:"tel",name:"phone",placeholder:"Enter your phone number",defaultValue:a||"",onChange:this.props.handleOrderFormInputChange}),this.state.phone_invalid?r.a.createElement(w.a.Text,{className:"text-danger"},"Invalid phone number. Enter valid phone number like +380671234567."):""),r.a.createElement(w.a.Group,{controlId:"formClientEmail"},r.a.createElement(w.a.Label,null,"Email address"),r.a.createElement(w.a.Control,{type:"email",required:!0,placeholder:"Enter email",name:"email",defaultValue:n||"",onChange:this.props.handleOrderFormInputChange}),this.state.email_invalid?r.a.createElement(w.a.Text,{className:"text-danger"},"Invalid email. Enter valid email."):"",r.a.createElement(w.a.Text,{className:"text-muted"},"We'll never share your email with anyone else.")),r.a.createElement(w.a.Group,{controlId:"formClientComent"},r.a.createElement(w.a.Label,null,"Comments"),r.a.createElement(w.a.Control,{as:"textarea",placeholder:"Comments",name:"comments",rows:"4",defaultValue:i||"",onChange:this.props.handleOrderFormInputChange})),r.a.createElement(w.a.Group,{as:N.a},r.a.createElement(A.a,{sm:{span:3,offset:9}},r.a.createElement(C.a,{type:"submit",variant:"primary"},"Submit"))))}}]),t}(r.a.Component),B=Object(p.b)(function(e){return{name:e.order.form.name,phone:e.order.form.phone,email:e.order.form.email,comments:e.order.form.comments,form:e.order.form,order_id:e.order.order_id,validation_error:e.order.validation_error,success_message:e.order.success_message}},function(e){return{handleOrderFormInputChange:function(t){return e(((n=t).preventDefault(),function(e){e({type:"ORDER_FORM_INPUT_CHANGE",key:n.target.name,value:n.target.value})}));var n},submitOrderForm:function(t){return e(function(e){return function(t){g(t,"/api/orders/order_create/","SUBMIT_ORDER_FORM",e)}}(t))},moveIngredientsFromBasketToOrder:function(t){return e(function(e){var t={order:e};return function(e){g(e,"/api/orders/ingredients_in_order_create/","ORDER_CREATED",t)}}(t))},setFalseToSuccessMessage:function(){return e(function(e){e({type:"SET_FALSE_TO_SUCCESS_MESSAGE"})})},setFalseToValidationError:function(){return e(function(e){e({type:"SET_FALSE_TO_VALIDATION_ERROR"})})}}})(R),F=n(52),G=n.n(F),M=function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(l.a)(t).call(this,e,n))).handleShow=a.handleShow.bind(Object(h.a)(Object(h.a)(a))),a.handleClose=a.handleClose.bind(Object(h.a)(Object(h.a)(a))),a.handleCloseWarningForm=a.handleCloseWarningForm.bind(Object(h.a)(Object(h.a)(a))),a.showSuccessMessage=a.showSuccessMessage.bind(Object(h.a)(Object(h.a)(a))),a.closeSuccessMessage=a.closeSuccessMessage.bind(Object(h.a)(Object(h.a)(a))),a.showSpiner=a.showSpiner.bind(Object(h.a)(Object(h.a)(a))),a.showSpiner=a.showSpiner.bind(Object(h.a)(Object(h.a)(a))),a.closeSpiner=a.closeSpiner.bind(Object(h.a)(Object(h.a)(a))),a.state={show:!1,show_warning:!1,show_success_message:!1,spiner:!0},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleClose",value:function(){this.setState(Object(T.a)({},this.state,{show:!1}))}},{key:"handleCloseWarningForm",value:function(){this.setState(Object(T.a)({},this.state,{show_warning:!1}))}},{key:"handleShow",value:function(){var e=this,t=this.props.ingredients_in_basket,n=!1;t.forEach(function(t,a){t.is_dough&&(e.setState(Object(T.a)({},e.state,{show:!0})),n=!0)}),n||this.setState(Object(T.a)({},this.state,{show_warning:!0}))}},{key:"showSuccessMessage",value:function(){this.setState(Object(T.a)({},this.state,{show_success_message:!0,spiner:!0,show:!1}))}},{key:"closeSuccessMessage",value:function(){this.setState(Object(T.a)({},this.state,{show_success_message:!1}))}},{key:"showSpiner",value:function(){this.setState(Object(T.a)({},this.state,{spiner:!1}))}},{key:"closeSpiner",value:function(){this.setState(Object(T.a)({},this.state,{spiner:!0}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(C.a,{variant:"primary",onClick:this.handleShow},"Order"),r.a.createElement(G.a,{loaded:this.state.spiner}),r.a.createElement(D.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(D.a.Header,{closeButton:!0},r.a.createElement(D.a.Title,null,"Order form")),r.a.createElement(D.a.Body,null,r.a.createElement(B,{handleClose:this.handleClose,showSuccessMessage:this.showSuccessMessage,showSpiner:this.showSpiner,closeSpiner:this.closeSpiner}))),r.a.createElement(D.a,{show:this.state.show_warning,onHide:this.handleCloseWarningForm},r.a.createElement(D.a.Header,{closeButton:!0},r.a.createElement(D.a.Title,null,"Pleaze choose your dough!"))),r.a.createElement(D.a,{show:this.state.show_success_message,onHide:this.closeSuccessMessage},r.a.createElement(D.a.Header,{closeButton:!0},r.a.createElement(D.a.Title,null,"Success! Check your e-mail to confirm order."))))}}]),t}(r.a.Component),L=Object(p.b)(function(e){return{ingredients_in_basket:e.order.ingredients_in_basket}})(M),U=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement(y,null),r.a.createElement(L,null))}}]),t}(a.Component),P=n(23),x=n(27),H=n(56),K={menu:{categories:[],ingredients:[]},order:{ingredients_in_basket:[],form:{},order_id:!1,validation_error:!1,success_message:!1}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0,n=Object(T.a)({},e);switch(t.type){case"LOAD_CATEGORIES":n.menu=Object(T.a)({},n.menu,{categories:t.data});break;case"LOAD_INGREDIENTS":n.menu=Object(T.a)({},n.menu,{ingredients:t.data});break;case"LOAD_INGREDIENTS_IN_BASKET":var a=t.data;n.order=Object(T.a)({},n.order,{ingredients_in_basket:a});break;case"ADD_INGREDIENT_TO_BASKET":n.order.ingredients_in_basket=[].concat(Object(H.a)(n.order.ingredients_in_basket),[t.data]);break;case"UPDATE_INGREDIENT_IN_BASKET":var r=n.order.ingredients_in_basket.map(function(e,n){return e.id===t.data.id?Object(T.a)({},e,{nmb:t.data.nmb,ingredient:t.data.ingredient,total_price:t.data.total_price}):e});n.order=Object(T.a)({},n.order,{ingredients_in_basket:r});break;case"DELETE_INGREDIENT_IN_BASKET":n.order.ingredients_in_basket=n.order.ingredients_in_basket.filter(function(e){return e.id!==t.data});break;case"ORDER_FORM_INPUT_CHANGE":n.order.form=Object(T.a)({},n.order.form,Object(x.a)({},t.key,t.value));break;case"SUBMIT_ORDER_FORM":t.data.id?n.order=Object(T.a)({},n.order,{order_id:t.data.id}):n.order=Object(T.a)({},n.order,{validation_error:t.data});break;case"ORDER_CREATED":t.data.order===n.order.order_id?n.order=Object(T.a)({},n.order,{order_id:!1,success_message:!0,ingredients_in_basket:[]}):n.order=Object(T.a)({},n.order,{validation_error:t.data});break;case"SET_FALSE_TO_SUCCESS_MESSAGE":n.order=Object(T.a)({},n.order,{success_message:!1});break;case"SET_FALSE_TO_VALIDATION_ERROR":n.order=Object(T.a)({},n.order,{validation_error:!1})}return n},q=n(55),z=Object(P.c)(V,Object(P.a)(q.a));s.a.render(r.a.createElement(p.a,{store:z},r.a.createElement(U,null)),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.162e20a4.chunk.js.map